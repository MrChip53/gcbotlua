function main()
	--Read gold amount
	if Bot.IS_PLAYING then
		if Bot:FIND_IMAGE("replay.bmp") or Bot:FIND_IMAGE("event_back.bmp") then --IF TRUE WE ARE ON MAIN MENU(CASTLE SCREEN)
			local hwnd = Bot:GET_WINDOW()
			--Get gold
			local hdc = Misc:GET_HDC(hwnd)
			hdc = Misc:CROP_HDC(hdc, 15, 0, 130, 30)
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(139, 124, 37), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(125, 112, 39), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(229,199, 28), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(167, 148, 34), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(224, 195, 28), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(210,184, 29), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(178, 156, 33), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(243, 211, 26), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(243, 178, 26), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(216, 160, 29), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(165, 126, 34), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(215, 159, 29), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(232, 170, 27), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(214, 159, 29), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(146, 113, 36), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(236, 173, 27), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(240, 176, 26), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(194, 145, 31), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_COLOR(hdc, Misc:GET_COLOR(175, 132, 33), Misc:GET_COLOR(255, 0, 0))
			Misc:REPLACE_ALL_COLORS_EXCEPT(hdc, Misc:GET_COLOR(255, 0, 0), Misc:GET_COLOR(0, 0, 0))
			--Misc:SAVE_HDC(hdc, "gold")
			--Bot:WAIT(25)
			Gold = Misc:READ_HDC_TEXT(hdc, "gc")
			Gold = Gold:gsub("%\n", "")
			Gold = Gold:gsub("%.", ",")
			--Get Diamonds
			local hdc2 = Misc:GET_HDC(hwnd)
			hdc2 = Misc:CROP_HDC(hdc2, 190, 0, 70, 30)
			Misc:REPLACE_COLOR(hdc2, Misc:GET_COLOR(204, 204, 204), Misc:GET_COLOR(255, 255, 255))
			Misc:REPLACE_COLOR(hdc2, Misc:GET_COLOR(235, 235, 235), Misc:GET_COLOR(255, 255, 255))
			Misc:REPLACE_COLOR(hdc2, Misc:GET_COLOR(243, 243, 243), Misc:GET_COLOR(255, 255, 255))
			Misc:REPLACE_COLOR(hdc2, Misc:GET_COLOR(162, 162, 162), Misc:GET_COLOR(255, 255, 255))
			Misc:REPLACE_COLOR(hdc2, Misc:GET_COLOR(193, 193, 193), Misc:GET_COLOR(255, 255, 255))
			Misc:REPLACE_COLOR(hdc2, Misc:GET_COLOR(189, 189, 189), Misc:GET_COLOR(255, 255, 255))
			Misc:REPLACE_COLOR(hdc2, Misc:GET_COLOR(100, 100, 100), Misc:GET_COLOR(255, 255, 255))
			Misc:REPLACE_COLOR(hdc2, Misc:GET_COLOR(72, 72, 72), Misc:GET_COLOR(255, 255, 255))
			Misc:REPLACE_COLOR(hdc2, Misc:GET_COLOR(121, 121, 121), Misc:GET_COLOR(255, 255, 255))
			Misc:REPLACE_ALL_COLORS_EXCEPT(hdc2, Misc:GET_COLOR(255, 255, 255), Misc:GET_COLOR(0, 0, 0))
			--Misc:SAVE_HDC(hdc2, "d")
			--Bot:WAIT(25)
			Diamonds = Misc:READ_HDC_TEXT(hdc2, "gc")
			Diamonds = Diamonds:gsub("%\n", "")
			if tonumber(Diamonds) ~= nil then
			   Bot:SET_GLOBAL("DIAMOND", ""..tonumber(Diamonds))
			end
			Bot:SET_CONTROL_TEXT(70001, "Gold: " .. Gold .. " Diamonds: " .. Diamonds)
			Bot:WAIT(100)
		end
	end
end
